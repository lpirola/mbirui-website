---
import { getCollection } from 'astro:content';
import Layout from '~/layouts/PageLayout.astro';
import Hero from '~/components/widgets/Hero.astro';

const artigos = (await getCollection('artigos'))
  .sort((a, b) => b.data.data - a.data.data);

const metadata = {
  title: 'Artigos — Projeto Mbiru\'i',
  description: 'Artigos científicos, divulgação e relatos metodológicos.',
};
---

<Layout metadata={metadata}>
  <Hero>
    <Fragment slot="title">
      Artigos e <span class="text-accent dark:text-white">Publicações</span>
    </Fragment>

    <Fragment slot="subtitle">
      Artigos científicos, divulgação e relatos metodológicos.
    </Fragment>
  </Hero>

  <section class="py-12 sm:py-16 lg:py-20">
    <div class="container mx-auto px-4 max-w-4xl">
      <ul class="space-y-6">
        {artigos.map(({ slug, data }) => (
          <li class="border-b pb-6">
            <a
              href={`/artigos/${slug}`}
              class="text-2xl font-semibold hover:text-blue-600 dark:hover:text-blue-400 block mb-2"
            >
              {data.title}
            </a>
            <p class="text-gray-600 dark:text-gray-300 mb-3">
              {data.excerpt}
            </p>
            <div class="flex flex-wrap gap-2 mb-3">
              {data.tags && data.tags.map((tag) => (
                <span class="text-sm px-3 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200">
                  #{tag}
                </span>
              ))}
            </div>
            <small class="text-gray-500 dark:text-gray-400 block">
              {new Date(data.data).toLocaleDateString('pt-BR')}
              {data.autor && ` • ${data.autor}`}
            </small>
          </li>
        ))}
      </ul>
    </div>
  </section>
</Layout>
